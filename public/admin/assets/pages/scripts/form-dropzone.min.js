var FormDropzone = function () {
    return {
        init: function () {
            Dropzone.options.myDropzone = {
                dictDefaultMessage: "", init: function () {
                    this.on("addedfile", function (e) {

                        var n = Dropzone.createElement("<a href='javascript:;'' class='btn red btn-sm btn-block hidden-files'>Remove</a>"), t = this;
                        n.addEventListener("click", function (n) {
                            var d = $(this).parent();
                            var v = d.find('.h-file').val();
                            $.ajax({
                                url: url_rmv_file,
                                type: "POST",
                                /*async: false,*/
                                data: {
                                    _token : CSRF_TOKEN,
                                    f: v
                                },
                            });

                            n.preventDefault(), n.stopPropagation(), t.removeFile(e)
                        }), e.previewElement.appendChild(n)
                    }),
                        this.on('sending', function(file, xhr, formData){formData.append("_token", CSRF_TOKEN)}),
                        this.on("success", function(e, responseText) {
                            var n = Dropzone.createElement('<input class="h-file" type="hidden" name="image_url[]" value="'+ responseText +'">');
                            e.previewElement.appendChild(n);
                        })
                }
            }
        }
    }
}();

jQuery(document).ready(function () {
    FormDropzone.init()
});